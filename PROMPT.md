# ストーリー

昔々、高橋王国にはたくさんの都市が点在していましたが、道路が無く人々は都市間の移動に苦労していました。

そこで国王の高橋くんは、都市をいくつかのグループに分け、グループ内の任意の2都市間が道路によって互いに行き来できるように都市を結ぶ道路を建設することで、国を発展させる計画を考えました。

高橋くんはなるべく建設する道路の総長を短くしたいと考えていましたが、高橋王国には正確な地図が無く、各都市の位置がはっきりしていないという問題がありました。

どのように道路を建設するべきか困った高橋くんは、王国一の占い師に助けを求めることにしました。

占い師は、いくつかの都市を選ぶことで、それらの都市同士を互いに行き来できるような総長の最も短い道路の建設方法を知ることができます。

ただし、占いの回数には限界があります。

なるべく建設する道路の総長を短くできるように、最適な占い方および道路の建設計画を考えてください。

# 問題文

平面上にN個の都市があり、0からN−1までの番号が付けられている。

都市iの座標は(xi,yi)としてジャッジ内部では定まっているが、入力では与えられない。

その代わりに都市iが存在する可能性のある座標の長方形範囲 lxi,rxi,lyi,ryiが与えられ、lxi≤xi≤rxiおよびlyi≤yi≤ryiを満たす。

都市間の距離はユークリッド距離の小数点以下を切り捨てた整数値 dist(i,j)=ceil(pow(xi−xj, 2)+pow(yi−yj, 2)) として定義される。

長さ Mの配列Gが与えられる。各グループの大きさがそれぞれ G0,G1,…,GM−1 となるように都市をM個のグループに分割し、同じグループ内の都市が連結になるように道路を建設したい。

回答の出力を行う前に、占いとして以下の形式のクエリを最大 Q 回まで行うことができる。

- 都市の集合 C⊂{0,1,⋯,N−1} を選ぶ。ただし、その大きさ l=∣C∣ は、入力で指定される上限サイズ L に対して 2≤l≤L を満たす必要がある。
- クエリに対する応答として、都市集合 C 上での最小全域木を構成するための l−1 本の道路それぞれが接続する都市の組が得られる。ここで、最小全域木は以下のアルゴリズムによって構築される。
  - 辺の配列 E を、都市集合 C に含まれる任意の 2 都市間の辺で初期化する。
  - E を都市間の距離の昇順にソートする。都市間の距離は都市の真の座標に基づいて計算される。都市間の距離が等しい辺については、辺が結ぶ2つの都市 `u<v` のペア (u,v) について昇順となるようにソートする。
  - E の先頭から順に辺を取り出し、その辺を追加したときに閉路ができないならば、その辺を最小全域木に追加する。
  - 最小全域木を構成する各辺について、辺が結ぶ2つの都市 `u<v` のペア (u,v) について昇順にソートしたものをクエリに対する応答とする。

その後、以下を満たすような都市のグループ分けおよび道路の建設計画を出力せよ。

- N 個の都市を M 個のグループに分ける。各グループ i には Gi個の都市を割り当てる必要がある。いずれのグループにも割り当てられない都市や、複数のグループに割り当てられるような都市があってはならない。
- 各グループ i について、そのグループに属する都市間を結ぶ道路を Gi−1 本選ぶ。このとき、各グループ内の任意の2都市間が道路によって相互に到達可能、すなわちグラフとして連結となる必要がある。

なお、それぞれの道路はその両端の 2 都市間のみを結ぶ。複数の道路が平面交差していても、道路から道路へ移ることはできない。

## 得点

出力した道路の建設計画における全ての道路の総長が絶対スコアとなる。

都市 i と都市 j を結ぶ道路の長さは、真の座標を用いて計算された都市間の距離 dist(i,j)=⌊(xi−xj)**2+(yi−yj)**2⌋ として計算される。

絶対スコアは小さければ小さいほど良い。


## 入出力

まず初めに、都市の個数 N 、回答における都市のグループの個数 M 、最大クエリ回数 Q 、クエリを行う都市の集合のサイズの上限 L 、都市の座標が含まれる長方形の幅や高さとして有り得る最大値 W 、各グループに割り当てる都市の個数を表す配列 G 、各都市が存在する可能性のある座標の長方形範囲 lxi,rxi,lyi,ryiが、以下の形式で標準入力から与えられる。

```
N M Q L W
G0 G1⋯GM−1
lx0 rx0 ly0 ry0
⋮
lxN−1 rxN−1 lyN−1 ryN−1
```

各値はそれぞれ以下の制約を満たす。

- N=800
- 1≤M≤400
- Q=400
- 3≤L≤15
- 500≤W≤2500
- 1≤Gi≤N
- sum(G1, G2, ... , GM-1) = N
- 0≤lxi≤rxi≤10000
- 0≤rxi−lxi≤W
- 0≤lyi≤ryi≤10000
- 0≤ryi−lyi≤W
- 入力は全て整数である。

上記の情報を読み込んだ後、以下のクエリを最大 Q 回まで繰り返す。

各クエリでは、都市の集合C⊂{0,1,⋯,N−1}を選ぶ。ただし、その大きさl=∣C∣は入力で指定される上限サイズLに対して2≤l≤Lを満たす必要がある。これらの値を以下の形式で一行で標準出力に出力せよ

```
? l C0 C1 ⋯ Cl−1
```

出力の後には改行をし、更に標準出力を flush しなければならない。

出力後に、都市集合 C 上での最小全域木を構成するための l−1 本の道路それぞれが接続する都市の組 ai,bi∈C が、以下の形式で標準入力から与えられる。

```
a0 b0
⋮
al−2 bl−2
​```

最大 Q 回までのクエリ処理が完了後、まず初めに記号 ! のみを一行で標準出力に出力せよ。

```
!
```

その後、各グループに対する回答を以下の形式でMグループ分繰り返し出力せよ。グループkに対する回答では、そのグループに割り当てる都市の集合C⊂{0,1,⋯,N−1}と、その都市間を結ぶ道路の組ai,bi∈Cを以下の形式で出力せよ。

```
C0 C1 ⋯ CGk−1
a0 b0
⋮
aGk−2 bGk−2
```

この時、出力は以下の制約を満たす必要がある。

- 各都市は必ず1つのグループに割り当てられる。どのグループにも割り当てられない都市や、複数のグループに割り当てられる都市は存在しない。
- 各グループ内の任意の2都市間は道路によって相互に到達可能、すなわちグラフとして連結である。